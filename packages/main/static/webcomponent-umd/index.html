<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supabase Auth Web Component Test</title>
    <link rel="stylesheet" href="../webcomponent-page.css">
</head>
<body>
    <div class="container config-section">
        <p>
            This page demonstrates the use of the Supabase Auth web component in a plain HTML document.
            It is configured to use a default local Supabase project. You can set it to interact with
            your own Supabase instance by updating the configuration belowâ€”<span>do so at your own risk</span>.
        </p>
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <label for="supabaseUrl">
                <div>Supabase URL</div>
                <input type="text" id="supabaseUrl" placeholder="https://your-project.supabase.co" value="http://localhost:54321">
            </label>
            <label for="supabaseAnonKey">
                <div>Supabase Anon Key</div>
                <input type="text" id="supabaseAnonKey" placeholder="your-anon-key" value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0">
            </label>
            <button onclick="updateConfig()">Update Configuration</button>
        </div>
    </div>

    <div class="container auth-container">
        <div class="auth-section">

            <supabase-auth
                id="basicAuth"
                supabase-url="http://localhost:54321"
                supabase-anon-key="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0"
                initial-view="sign_in_with_password"
                auth-options='{"auth":{"email":{"enable_signup":true},"mfa":{"required":false}}}'
            ></supabase-auth>

        </div>

    </div>

    <!-- Load Supabase client library (always from CDN) -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <!-- Load the web component without fetch (works over file://) -->
    <script>
      (function () {
        const isFile = window.location.protocol === 'file:';
        const isLocalHost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        const useLocal = isFile || isLocalHost;
    
        const script = document.createElement('script');
        script.defer = true;
        script.src = useLocal
          ? '../webcomponent/supabase-auth-web-component.umd.cjs'
          : 'https://unpkg.com/svelte-supabase-auth@latest/dist/supabase-auth-web-component.umd.cjs';
        document.head.appendChild(script);
      })();
    </script>

    <script>
        // Global functions for the buttons
        window.updateConfig = function() {
            const url = document.getElementById('supabaseUrl').value;
            const key = document.getElementById('supabaseAnonKey').value;

            if (!url || !key) {
                alert('Please provide both Supabase URL and anon key');
                return;
            }

            // Update both auth components
            const basicAuth = document.getElementById('basicAuth');

            basicAuth.setAttribute('supabase-url', url);
            basicAuth.setAttribute('supabase-anon-key', key);
        };
    </script>
</body>
</html>
